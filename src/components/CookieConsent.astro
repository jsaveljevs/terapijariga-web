---
interface Props {
  lang?: string;
}

const { lang = 'lv' } = Astro.props;

const translations = {
  lv: {
    text: 'Šī mājas lapa izmanto Google Maps, kas var iestatīt sīkdatnes.',
    accept: 'Sapratu',
    learnMore: 'Privātuma politika',
  },
  ru: {
    text: 'Этот сайт использует Google Maps, который может устанавливать cookies.',
    accept: 'Понятно',
    learnMore: 'Политика конфиденциальности',
  },
  en: {
    text: 'This website uses Google Maps, which may set cookies.',
    accept: 'Got it',
    learnMore: 'Privacy Policy',
  },
};

const t = translations[lang as keyof typeof translations] || translations.lv;
const privacyUrl = lang === 'lv' ? '/privacy/' : `/${lang}/privacy/`;
---

<div id="cookie-consent" class="fixed bottom-0 left-0 right-0 z-50 p-4 hidden">
  <div class="max-w-4xl mx-auto bg-neutral-900 text-white rounded-2xl p-4 sm:p-6 shadow-2xl flex flex-col sm:flex-row items-center gap-4">
    <p class="text-sm text-neutral-300 flex-1">
      {t.text}
      <a href={privacyUrl} class="text-primary-300 hover:text-primary-200 underline ml-1">
        {t.learnMore}
      </a>
    </p>
    <button
      id="cookie-accept"
      class="px-6 py-2 bg-white text-neutral-900 font-medium rounded-xl hover:bg-neutral-100 transition-colors text-sm whitespace-nowrap"
    >
      {t.accept}
    </button>
  </div>
</div>

<script>
  const COOKIE_CONSENT_KEY = 'cookie-consent-accepted';

  function showCookieConsent() {
    const consent = localStorage.getItem(COOKIE_CONSENT_KEY);
    if (!consent) {
      const banner = document.getElementById('cookie-consent');
      if (banner) {
        banner.classList.remove('hidden');
      }
    }
  }

  function acceptCookies() {
    localStorage.setItem(COOKIE_CONSENT_KEY, 'true');
    const banner = document.getElementById('cookie-consent');
    if (banner) {
      banner.classList.add('hidden');
    }
  }

  document.getElementById('cookie-accept')?.addEventListener('click', acceptCookies);

  // Show banner after a short delay
  setTimeout(showCookieConsent, 1000);
</script>
