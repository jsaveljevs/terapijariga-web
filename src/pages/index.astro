---
import Layout from '../layouts/Layout.astro';
import { getLangFromUrl, useTranslations } from '../i18n/ui';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

function getLocalizedUrl(locale: string, route: string): string {
  if (locale === 'lv') {
    return route === '/' ? '/' : route;
  }
  return route === '/' ? `/${locale}` : `/${locale}${route}`;
}

const structuredData = {
  "@context": "https://schema.org",
  "@type": "MedicalBusiness",
  "@id": "https://terapijariga.lv/#business",
  "name": "Gestalt Psychotherapist in Riga ‚Äì Kristƒ´na",
  "alternateName": "TerapijaRiga.lv",
  "url": "https://terapijariga.lv/",
  "telephone": "+371 XX XXX XXX",
  "email": "you@terapijariga.lv",
  "description": "Gestalt psychotherapy in Riga for adults. Help with anxiety, burnout, relationships, self-worth and trauma. In-person and online sessions in Latvian, Russian and English.",
  "image": "https://terapijariga.lv/images/portrait.jpg",
  "priceRange": "‚Ç¨‚Ç¨",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Riga",
    "addressRegion": "Riga",
    "addressCountry": "LV"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": 56.9496,
    "longitude": 24.1052
  },
  "openingHoursSpecification": [
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
      "opens": "09:00",
      "closes": "19:00"
    }
  ],
  "availableLanguage": [
    {
      "@type": "Language",
      "name": "Latvian",
      "alternateName": "lv"
    },
    {
      "@type": "Language",
      "name": "Russian",
      "alternateName": "ru"
    },
    {
      "@type": "Language",
      "name": "English",
      "alternateName": "en"
    }
  ],
  "medicalSpecialty": "Psychiatric",
  "hasOfferCatalog": {
    "@type": "OfferCatalog",
    "name": "Psychotherapy Services",
    "itemListElement": [
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Individual Psychotherapy",
          "description": "One-on-one Gestalt therapy sessions for adults"
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Online Psychotherapy",
          "description": "Video call therapy sessions"
        }
      }
    ]
  },
  "sameAs": []
};
---

<Layout
  title={t('home.title')}
  description={t('home.description')}
  structuredData={structuredData}
>
  <!-- Hero Section -->
  <section class="bg-gradient-to-b from-white to-warm-100 py-16 sm:py-24">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <div class="order-2 lg:order-1">
          <h1 class="text-3xl sm:text-4xl lg:text-5xl font-serif font-bold text-gray-900 leading-tight mb-6">
            {t('home.h1')}
          </h1>
          <p class="text-lg text-gray-600 mb-4">
            {t('home.intro')}
          </p>
          <p class="text-lg text-gray-600 mb-8">
            {t('home.intro2')}
          </p>
          <div class="flex flex-col sm:flex-row gap-4">
            <a
              href={getLocalizedUrl(lang, '/contact')}
              class="inline-flex items-center justify-center px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors shadow-sm"
            >
              {t('home.cta.book')}
            </a>
            <a
              href={getLocalizedUrl(lang, '/services')}
              class="inline-flex items-center justify-center px-6 py-3 bg-white text-primary-700 font-medium rounded-lg border border-primary-200 hover:bg-primary-50 transition-colors"
            >
              {t('home.cta.services')}
            </a>
          </div>
        </div>
        <div class="order-1 lg:order-2 flex justify-center">
          <div class="relative w-64 h-64 sm:w-80 sm:h-80 lg:w-96 lg:h-96">
            <div class="absolute inset-0 bg-primary-200 rounded-full opacity-20"></div>
            <img
              src="/images/portrait.jpg"
              alt="Kristƒ´na ‚Äì Gestalt psychotherapist in Riga"
              class="relative w-full h-full object-cover rounded-full border-4 border-white shadow-lg"
              onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 400 400%22><rect fill=%22%23e8e0d6%22 width=%22400%22 height=%22400%22/><text x=%2250%%22 y=%2250%%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 fill=%22%238d7259%22 font-size=%2224%22>Photo</text></svg>'"
            />
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- What I Help With -->
  <section class="py-16 sm:py-20 bg-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl sm:text-3xl font-serif font-bold text-gray-900 text-center mb-12">
        {t('home.help.title')}
      </h2>
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
        {[
          { key: 'anxiety', icon: 'üåä' },
          { key: 'burnout', icon: 'üî•' },
          { key: 'relationships', icon: 'üíî' },
          { key: 'selfworth', icon: 'ü™û' },
          { key: 'trauma', icon: 'üå±' },
          { key: 'psychosomatic', icon: 'üß†' },
          { key: 'transitions', icon: 'üîÑ' },
          { key: 'loneliness', icon: 'ü§ù' },
        ].map(({ key, icon }) => (
          <div class="p-5 bg-warm-50 rounded-xl border border-warm-200 hover:border-primary-300 transition-colors">
            <div class="text-2xl mb-3" aria-hidden="true">{icon}</div>
            <p class="text-gray-700 font-medium">{t(`home.help.${key}` as any)}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- How Therapy Works -->
  <section class="py-16 sm:py-20 bg-warm-50">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl sm:text-3xl font-serif font-bold text-gray-900 text-center mb-12">
        {t('home.process.title')}
      </h2>
      <div class="grid md:grid-cols-3 gap-8">
        {[1, 2, 3].map((step) => (
          <div class="relative">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-primary-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
                {step}
              </div>
              {step < 3 && (
                <div class="hidden md:block flex-1 h-0.5 bg-primary-200 ml-4"></div>
              )}
            </div>
            <h3 class="text-xl font-semibold text-gray-900 mb-3">
              {t(`home.process.step${step}.title` as any)}
            </h3>
            <p class="text-gray-600">
              {t(`home.process.step${step}.text` as any)}
            </p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Languages -->
  <section class="py-16 sm:py-20 bg-white">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-2xl sm:text-3xl font-serif font-bold text-gray-900 mb-6">
        {t('home.languages.title')}
      </h2>
      <p class="text-lg text-gray-600 mb-8">
        {t('home.languages.text')}
      </p>
      <div class="flex justify-center gap-4 flex-wrap">
        <span class="px-4 py-2 bg-warm-100 text-gray-700 rounded-full font-medium">Latvie≈°u</span>
        <span class="px-4 py-2 bg-warm-100 text-gray-700 rounded-full font-medium">–†—É—Å—Å–∫–∏–π</span>
        <span class="px-4 py-2 bg-warm-100 text-gray-700 rounded-full font-medium">English</span>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 sm:py-20 bg-primary-700">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-2xl sm:text-3xl font-serif font-bold text-white mb-6">
        {t('home.cta.title')}
      </h2>
      <p class="text-lg text-primary-100 mb-8">
        {t('home.cta.text')}
      </p>
      <div class="flex flex-col sm:flex-row justify-center gap-6 text-white">
        <div>
          <p class="text-primary-200 text-sm mb-1">{t('home.cta.email')}</p>
          <a href="mailto:you@terapijariga.lv" class="text-lg font-medium hover:underline">
            you@terapijariga.lv
          </a>
        </div>
        <div class="hidden sm:block w-px bg-primary-500"></div>
        <div>
          <p class="text-primary-200 text-sm mb-1">{t('home.cta.phone')}</p>
          <a href="tel:+371XXXXXXXX" class="text-lg font-medium hover:underline">
            +371 XX XXX XXX
          </a>
        </div>
      </div>
      <div class="mt-8">
        <a
          href={getLocalizedUrl(lang, '/contact')}
          class="inline-flex items-center justify-center px-8 py-3 bg-white text-primary-700 font-medium rounded-lg hover:bg-warm-50 transition-colors shadow-sm"
        >
          {t('home.cta.book')}
        </a>
      </div>
    </div>
  </section>
</Layout>
